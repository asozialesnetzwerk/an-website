{
  "version": 3,
  "sources": ["../../../utils/better_ui_.ts", "../../../utils/jsx_runtime_.ts", "../../../utils/utils.ts"],
  "sourcesContent": ["// @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-3.0-or-later\ntype EventHandler<T extends keyof HTMLElementEventMap> = (\n    event: HTMLElementEventMap[T],\n) => unknown;\nconst addEventListener = <T extends keyof HTMLElementEventMap>(\n    element: HTMLElement,\n    type: T,\n    fun: EventHandler<T>,\n) => {\n    element.addEventListener(type, fun);\n};\n\ntype DocumentEventHandler<T extends keyof DocumentEventMap> = (\n    event: DocumentEventMap[T],\n) => unknown;\nconst addDocumentEventListener = <T extends keyof DocumentEventMap>(\n    type: T,\n    fun: DocumentEventHandler<T>,\n) => {\n    document.addEventListener(type, fun);\n};\n\nconst openPane = document.getElementById(\"open-pane\");\nconst sitePane = document.getElementById(\"site-pane\");\n\nif (!openPane || !sitePane) {\n    throw Error(\"open-pane or site-pane not found\");\n}\n\nconst setSitePaneState = (state: \"open\" | \"close\") => {\n    console.debug(`${state} sitePane`);\n    sitePane.setAttribute(\"state\", state);\n};\n\nexport const showSitePane = () => {\n    setSitePaneState(\"open\");\n};\nexport const hideSitePane = () => {\n    setSitePaneState(\"close\");\n};\n\nconst belongsToSitePane = (el: HTMLElement) => (\n    el === openPane || el === sitePane || sitePane.contains(el)\n);\n\n// mouse users\naddEventListener(openPane, \"mouseover\", showSitePane);\naddEventListener(openPane, \"mouseleave\", hideSitePane);\n\n// keyboard users\naddDocumentEventListener(\"focusin\", (event) => {\n    if (belongsToSitePane(event.target as HTMLElement)) {\n        console.debug(\"showing site pane because of focus event\", event);\n        showSitePane();\n    } else {\n        console.debug(\"hiding site pane because of focus event\", event);\n        hideSitePane();\n    }\n});\naddDocumentEventListener(\"focusout\", (event) => {\n    if (belongsToSitePane(event.target as HTMLElement)) {\n        console.debug(\"hiding site pane because of blur event\", event);\n        hideSitePane();\n    } else {\n        console.debug(\"blur event\", event);\n    }\n});\n\n// phone users\naddEventListener(openPane, \"click\", showSitePane);\naddDocumentEventListener(\"click\", (event) => {\n    if (!belongsToSitePane(event.target as HTMLElement)) {\n        hideSitePane();\n    }\n});\n\n// swipe gestures (for phone users)\nconst startPos: { x: number | null; y: number | null } = {\n    x: null,\n    y: null,\n};\naddDocumentEventListener(\"touchstart\", (event) => {\n    // save start pos of touch\n    startPos.x = event.touches[0]?.clientX ?? null;\n    startPos.y = event.touches[0]?.clientY ?? null;\n});\naddDocumentEventListener(\"touchmove\", (event) => {\n    if (startPos.x === null || startPos.y === null) {\n        return;\n    }\n    // calculate difference\n    const diffX = startPos.x - (event.touches[0]?.clientX ?? 0);\n    const diffY = startPos.y - (event.touches[0]?.clientY ?? 0);\n\n    // early return if just clicked, not swiped\n    if (diffX === 0 && diffY === 0) {\n        return;\n    }\n\n    // reset start pos\n    startPos.x = null;\n    startPos.y = null;\n\n    const minDiffX = Math.max(12, 0.01 * screen.width, diffY * 1.5);\n\n    console.debug({ diffX, minDiffX });\n\n    if (Math.abs(diffX) >= minDiffX) {\n        if (diffX > 0) {\n            showSitePane();\n        } else {\n            hideSitePane();\n        }\n    }\n});\n", "// @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&dn=expat.txt MIT\nimport { d } from \"./utils.js\";\ndeclare global {\n    // eslint-disable-next-line @typescript-eslint/no-namespace\n    namespace JSX {\n        interface __CanHaveChildren {\n            children?: (Node | string)[];\n        }\n        interface ___Props {\n            \"id\"?: string;\n            \"className\"?: string;\n            \"tooltip\"?: string;\n            \"style\"?: string;\n            \"aria-label\"?: string;\n        }\n\n        type __Events = {\n            [Prop in keyof HTMLElementEventMap as `on${Prop}`]?:\n                | undefined\n                | ((event: HTMLElementEventMap[Prop]) => void);\n        };\n\n        type __Props = ___Props & __Events;\n\n        interface IntrinsicElements {\n            div: __CanHaveChildren & __Props;\n            img: __CanHaveChildren & __Props & { src?: string; alt?: string };\n            ul: __CanHaveChildren & __Props;\n            li: __CanHaveChildren & __Props;\n            a: __CanHaveChildren & __Props & { href?: string };\n            p: __CanHaveChildren & __Props;\n            button: __CanHaveChildren & __Props & { title?: string };\n            input: __Props & {\n                type: string;\n                min?: string;\n                max?: string;\n                value?: string;\n            };\n            style: __CanHaveChildren;\n        }\n\n        type Element = Node | string;\n    }\n}\n\ntype Component = (props: Props, key?: string) => JSX.Element;\ntype Tag = (keyof JSX.IntrinsicElements) | Component;\ntype Props =\n    & Record<\n        string,\n        string | number | null | undefined | EventListener | EventListenerObject\n    >\n    & { children?: Children };\ntype Children = (Node | string)[];\n\nconst children = \"children\";\nconst className = \"className\";\n\nconst appendChildren = (element: ParentNode, children?: Children): void => {\n    children?.forEach((child) => {\n        element.append(child);\n    });\n};\n\nexport const jsx = (\n    tag: Tag,\n    props: Props,\n): JSX.Element => {\n    console.debug(\"jsx\", { tag, props });\n\n    // If the tag is a function component, pass props and children inside it\n    if (typeof tag === \"function\") {\n        return tag(props);\n    }\n\n    // Create the element and add attributes to it\n    const el = d.createElement(tag);\n\n    Object.entries(props).forEach(([key, val]) => {\n        if (key === children) {\n            // Append all children to the element\n            appendChildren(el, val as Children | undefined);\n        } else if (key === className) {\n            el[className] = val as string;\n        } else if (key.startsWith(\"on\")) {\n            if (val) {\n                el.addEventListener(\n                    key.slice(2),\n                    val as (EventListener | EventListenerObject),\n                );\n            }\n        } else {\n            el.setAttribute(key, val as string);\n        }\n    });\n\n    console.debug(\"rendered\", el);\n\n    return el;\n};\n\nexport const jsxs = (\n    tag: Tag,\n    props: Props & { children: Children },\n): JSX.Element => {\n    console.debug(\"jsxs\", { tag, props });\n    return jsx(tag, props);\n};\n\nexport const Fragment = (\n    props: { children?: Children },\n): JSX.Element => {\n    console.debug(\"Fragment\", props);\n    const frag = new DocumentFragment();\n    appendChildren(frag, props[children]);\n    return frag;\n};\n", "export const d = document;\nfunction getElementById(id: string): HTMLElement | null {\n    return d.getElementById(id);\n}\nexport const e = getElementById;\n\nlet lastLocation = String(location);\n\n// export function getLastLocation(): string { return lastLocation; }\n\nexport function setLastLocation(url: string): void {\n    lastLocation = url;\n}\n\nconst jsonContentType = \"application/json\";\n\nexport function post(\n    url: string,\n    params = {},\n    ondata = console.log,\n    onerror: (data: unknown) => void = console.error,\n    accept = jsonContentType,\n): Promise<void> {\n    return fetch(url, {\n        method: \"POST\",\n        body: JSON.stringify(params),\n        headers: {\n            \"Accept\": accept,\n            \"Content-Type\": jsonContentType,\n        },\n    })\n        .then((response) => response.json())\n        .catch(onerror)\n        .then(ondata)\n        .catch(onerror);\n}\n\nexport function get(\n    url: string,\n    params: Record<string, string> | string = {},\n    ondata = console.log,\n    onerror: (data: unknown) => void = console.error,\n    accept = jsonContentType,\n): Promise<void> {\n    const paramsString = (new URLSearchParams(params)).toString();\n    return fetch(paramsString ? `${url}?${paramsString}` : url, {\n        method: \"GET\",\n        headers: { Accept: accept },\n    })\n        .then(\n            (response) => response.json(),\n        )\n        .catch(onerror)\n        .then(ondata)\n        .catch(onerror);\n}\n\nexport const PopStateHandlers: Record<\n    string,\n    (state: PopStateEvent) => unknown\n> = {};\n\nconst urlParamChangeStateType = \"URLParamChange\";\n\nPopStateHandlers[urlParamChangeStateType] = () => {\n    // always reload the location if URLParamChange\n    location.reload();\n};\n\nexport function setURLParam(\n    param: string,\n    value: string,\n    state: unknown,\n    stateType = urlParamChangeStateType,\n    push = true,\n) {\n    return setMultipleURLParams([[param, value]], state, stateType, push);\n}\n\nexport function setMultipleURLParams(\n    params: [string, string][],\n    state: unknown,\n    stateType = urlParamChangeStateType,\n    push = true,\n) {\n    // log(\"setURLParam\", param, value, state, onpopstate);\n    const urlParams = new URLSearchParams(location.search);\n    params.forEach(([key, value]) => {\n        urlParams.set(key, value);\n    });\n    const newUrl =\n        `${location.origin}${location.pathname}?${urlParams.toString()}`;\n    // log(\"newUrl\", newUrl);\n    (state as { stateType: string }).stateType = stateType;\n    if (push && newUrl !== location.href) {\n        history.pushState(state, newUrl, newUrl);\n    } else {\n        history.replaceState(state, newUrl, newUrl);\n    }\n    lastLocation = location.href;\n    return newUrl;\n}\n\nfunction scrollToId() {\n    const header = getElementById(\"header\");\n    const el = getElementById(location.hash.slice(1));\n    if (header && el) {\n        scrollBy(\n            0,\n            el.getBoundingClientRect().top - Math.floor(\n                Number(getComputedStyle(header).height),\n            ),\n        );\n    }\n}\n// scroll after few ms so the scroll is right on page load\nsetTimeout(scrollToId, 4);\nwindow.onhashchange = scrollToId;\n\nwindow.onpopstate = (event: PopStateEvent) => {\n    if (lastLocation.split(\"#\")[0] === location.href.split(\"#\")[0]) {\n        // Only hash changed\n        lastLocation = location.href;\n        scrollToId();\n        return;\n    }\n    if (event.state) {\n        const state = event.state as { stateType: string };\n        const stateHandler = PopStateHandlers[state.stateType];\n        if (stateHandler) {\n            event.preventDefault();\n            stateHandler(event);\n            lastLocation = location.href;\n            scrollToId();\n            return;\n        } else {\n            console.error(\"No state handler\", state);\n        }\n    }\n\n    console.error(\"Couldn't handle\", event);\n    lastLocation = location.href;\n    location.reload();\n};\n\nexport { hideSitePane /*, showSitePane */ } from \"./better_ui_.js\";\nexport { Fragment, jsx, jsxs } from \"./jsx_runtime_.js\";\n"],
  "mappings": "AAAA;AAIA,IAAMA,EAAmB,CACrBC,EACAC,EACAC,IACC,CACDF,EAAQ,iBAAiBC,EAAMC,CAAG,CACtC,EAKMC,EAA2B,CAC7BF,EACAC,IACC,CACD,SAAS,iBAAiBD,EAAMC,CAAG,CACvC,EAEME,EAAW,SAAS,eAAe,WAAW,EAC9CC,EAAW,SAAS,eAAe,WAAW,EAEpD,GAAI,CAACD,GAAY,CAACC,EACd,MAAM,MAAM,kCAAkC,EAGlD,IAAMC,EAAoBC,GAA4B,CACpC,GAAG,OAAAA,EAAK,aACtBF,EAAS,aAAa,QAASE,CAAK,CACxC,EAEaC,EAAe,IAAM,CAC9BF,EAAiB,MAAM,CAC3B,EACaG,EAAe,IAAM,CAC9BH,EAAiB,OAAO,CAC5B,EAEMI,EAAqBC,GACvBA,IAAOP,GAAYO,IAAON,GAAYA,EAAS,SAASM,CAAE,EAI9DZ,EAAiBK,EAAU,YAAaI,CAAY,EACpDT,EAAiBK,EAAU,aAAcK,CAAY,EAGrDN,EAAyB,UAAYS,GAAU,CACvCF,EAAkBE,EAAM,MAAqB,EAE7CJ,EAAa,EAGbC,EAAa,CAErB,CAAC,EACDN,EAAyB,WAAaS,GAAU,CACxCF,EAAkBE,EAAM,MAAqB,GAE7CH,EAAa,CAIrB,CAAC,EAGDV,EAAiBK,EAAU,QAASI,CAAY,EAChDL,EAAyB,QAAUS,GAAU,CACpCF,EAAkBE,EAAM,MAAqB,GAC9CH,EAAa,CAErB,CAAC,EAGD,IAAMI,EAAmD,CACrD,EAAG,KACH,EAAG,IACP,EACAV,EAAyB,aAAeS,GAAU,CAjFlD,IAAAE,EAAAC,EAAAC,EAAAC,EAmFIJ,EAAS,GAAIE,GAAAD,EAAAF,EAAM,QAAQ,CAAC,IAAf,YAAAE,EAAkB,UAAlB,KAAAC,EAA6B,KAC1CF,EAAS,GAAII,GAAAD,EAAAJ,EAAM,QAAQ,CAAC,IAAf,YAAAI,EAAkB,UAAlB,KAAAC,EAA6B,IAC9C,CAAC,EACDd,EAAyB,YAAcS,GAAU,CAtFjD,IAAAE,EAAAC,EAAAC,EAAAC,EAuFI,GAAIJ,EAAS,IAAM,MAAQA,EAAS,IAAM,KACtC,OAGJ,IAAMK,EAAQL,EAAS,IAAKE,GAAAD,EAAAF,EAAM,QAAQ,CAAC,IAAf,YAAAE,EAAkB,UAAlB,KAAAC,EAA6B,GACnDI,EAAQN,EAAS,IAAKI,GAAAD,EAAAJ,EAAM,QAAQ,CAAC,IAAf,YAAAI,EAAkB,UAAlB,KAAAC,EAA6B,GAGzD,GAAIC,IAAU,GAAKC,IAAU,EACzB,OAIJN,EAAS,EAAI,KACbA,EAAS,EAAI,KAEb,IAAMO,EAAW,KAAK,IAAI,GAAI,IAAO,OAAO,MAAOD,EAAQ,GAAG,EAI1D,KAAK,IAAID,CAAK,GAAKE,IACfF,EAAQ,EACRV,EAAa,EAEbC,EAAa,EAGzB,CAAC,EClHD;AAuDA,IAAMY,EAAW,WACXC,EAAY,YAEZC,EAAiB,CAACC,EAAqBH,IAA8B,CACvEA,GAAA,MAAAA,EAAU,QAASI,GAAU,CACzBD,EAAQ,OAAOC,CAAK,CACxB,EACJ,EAEaC,EAAM,CACfC,EACAC,IACc,CAId,GAAI,OAAOD,GAAQ,WACf,OAAOA,EAAIC,CAAK,EAIpB,IAAMC,EAAKC,EAAE,cAAcH,CAAG,EAE9B,cAAO,QAAQC,CAAK,EAAE,QAAQ,CAAC,CAACG,EAAKC,CAAG,IAAM,CACtCD,IAAQV,EAERE,EAAeM,EAAIG,CAA2B,EACvCD,IAAQT,EACfO,EAAGP,CAAS,EAAIU,EACTD,EAAI,WAAW,IAAI,EACtBC,GACAH,EAAG,iBACCE,EAAI,MAAM,CAAC,EACXC,CACJ,EAGJH,EAAG,aAAaE,EAAKC,CAAa,CAE1C,CAAC,EAIMH,CACX,EAEaI,EAAO,CAChBN,EACAC,IAGOF,EAAIC,EAAKC,CAAK,EAGZM,EACTN,GACc,CAEd,IAAMO,EAAO,IAAI,iBACjB,OAAAZ,EAAeY,EAAMP,EAAMP,CAAQ,CAAC,EAC7Bc,CACX,ECpHO,IAAMC,EAAI,SACjB,SAASC,EAAeC,EAAgC,CACpD,OAAOF,EAAE,eAAeE,CAAE,CAC9B,CACO,IAAMC,EAAIF,EAEbG,EAAe,OAAO,QAAQ,EAI3B,SAASC,EAAgBC,EAAmB,CAC/CF,EAAeE,CACnB,CAEA,IAAMC,EAAkB,mBAEjB,SAASC,EACZF,EACAG,EAAS,CAAC,EACVC,EAAS,QAAQ,IACjBC,EAAmC,QAAQ,MAC3CC,EAASL,EACI,CACb,OAAO,MAAMD,EAAK,CACd,OAAQ,OACR,KAAM,KAAK,UAAUG,CAAM,EAC3B,QAAS,CACL,OAAUG,EACV,eAAgBL,CACpB,CACJ,CAAC,EACI,KAAMM,GAAaA,EAAS,KAAK,CAAC,EAClC,MAAMF,CAAO,EACb,KAAKD,CAAM,EACX,MAAMC,CAAO,CACtB,CAEO,SAASG,EACZR,EACAG,EAA0C,CAAC,EAC3CC,EAAS,QAAQ,IACjBC,EAAmC,QAAQ,MAC3CC,EAASL,EACI,CACb,IAAMQ,EAAgB,IAAI,gBAAgBN,CAAM,EAAG,SAAS,EAC5D,OAAO,MAAMM,EAAe,GAAG,OAAAT,EAAG,KAAI,OAAAS,GAAiBT,EAAK,CACxD,OAAQ,MACR,QAAS,CAAE,OAAQM,CAAO,CAC9B,CAAC,EACI,KACIC,GAAaA,EAAS,KAAK,CAChC,EACC,MAAMF,CAAO,EACb,KAAKD,CAAM,EACX,MAAMC,CAAO,CACtB,CAEO,IAAMK,EAGT,CAAC,EAECC,EAA0B,iBAEhCD,EAAiBC,CAAuB,EAAI,IAAM,CAE9C,SAAS,OAAO,CACpB,EAEO,SAASC,EACZC,EACAC,EACAC,EACAC,EAAYL,EACZM,EAAO,GACT,CACE,OAAOC,EAAqB,CAAC,CAACL,EAAOC,CAAK,CAAC,EAAGC,EAAOC,EAAWC,CAAI,CACxE,CAEO,SAASC,EACZf,EACAY,EACAC,EAAYL,EACZM,EAAO,GACT,CAEE,IAAME,EAAY,IAAI,gBAAgB,SAAS,MAAM,EACrDhB,EAAO,QAAQ,CAAC,CAACiB,EAAKN,CAAK,IAAM,CAC7BK,EAAU,IAAIC,EAAKN,CAAK,CAC5B,CAAC,EACD,IAAMO,EACF,GAAG,gBAAS,QAAS,gBAAS,SAAQ,KAAI,OAAAF,EAAU,SAAS,GAEjE,OAACJ,EAAgC,UAAYC,EACzCC,GAAQI,IAAW,SAAS,KAC5B,QAAQ,UAAUN,EAAOM,EAAQA,CAAM,EAEvC,QAAQ,aAAaN,EAAOM,EAAQA,CAAM,EAE9CvB,EAAe,SAAS,KACjBuB,CACX,CAEA,SAASC,GAAa,CAClB,IAAMC,EAAS5B,EAAe,QAAQ,EAChC6B,EAAK7B,EAAe,SAAS,KAAK,MAAM,CAAC,CAAC,EAC5C4B,GAAUC,GACV,SACI,EACAA,EAAG,sBAAsB,EAAE,IAAM,KAAK,MAClC,OAAO,iBAAiBD,CAAM,EAAE,MAAM,CAC1C,CACJ,CAER,CAEA,WAAWD,EAAY,CAAC,EACxB,OAAO,aAAeA,EAEtB,OAAO,WAAcG,GAAyB,CAC1C,GAAI3B,EAAa,MAAM,GAAG,EAAE,CAAC,IAAM,SAAS,KAAK,MAAM,GAAG,EAAE,CAAC,EAAG,CAE5DA,EAAe,SAAS,KACxBwB,EAAW,EACX,MACJ,CACA,GAAIG,EAAM,MAAO,CACb,IAAMV,EAAQU,EAAM,MACdC,EAAehB,EAAiBK,EAAM,SAAS,EACrD,GAAIW,EAAc,CACdD,EAAM,eAAe,EACrBC,EAAaD,CAAK,EAClB3B,EAAe,SAAS,KACxBwB,EAAW,EACX,MACJ,MACI,QAAQ,MAAM,mBAAoBP,CAAK,CAE/C,CAEA,QAAQ,MAAM,kBAAmBU,CAAK,EACtC3B,EAAe,SAAS,KACxB,SAAS,OAAO,CACpB",
  "names": ["addEventListener", "element", "type", "fun", "addDocumentEventListener", "openPane", "sitePane", "setSitePaneState", "state", "showSitePane", "hideSitePane", "belongsToSitePane", "el", "event", "startPos", "_a", "_b", "_c", "_d", "diffX", "diffY", "minDiffX", "children", "className", "appendChildren", "element", "child", "jsx", "tag", "props", "el", "d", "key", "val", "jsxs", "Fragment", "frag", "d", "getElementById", "id", "e", "lastLocation", "setLastLocation", "url", "jsonContentType", "post", "params", "ondata", "onerror", "accept", "response", "get", "paramsString", "PopStateHandlers", "urlParamChangeStateType", "setURLParam", "param", "value", "state", "stateType", "push", "setMultipleURLParams", "urlParams", "key", "newUrl", "scrollToId", "header", "el", "event", "stateHandler"]
}
