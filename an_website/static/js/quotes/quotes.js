"use strict";// @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-3.0-or-later
function startQuotes(){const i=elById("next"),s=elById("upvote"),a=elById("downvote"),h=elById("report"),m=[elById("top").getAttribute("quote-id")],f=[i.getAttribute("quote-id")],r=window.location.search,o=(()=>{const e=new URLSearchParams(r).get("keys");return e!=null&&e.k.length?e.length===4?e.toUpperCase():(alert("Invalid keys given, using default."),"WASD"):"WASD"})();elById("wasd").innerText=`${o[0]} (Witzig), ${o[2]} (Nicht Witzig), ${o[1]} (Vorheriges) und ${o[3]} (Nächstes)`,document.onkeydown=e=>{switch(e.code){case`Key${o[0]}`:s.click();break;case`Key${o[1]}`:window.history.back();break;case`Key${o[2]}`:a.click();break;case`Key${o[3]}`:i.click()}};const T=elById("share"),$=elById("download"),g=elById("author"),u=elById("quote"),l=elById("real-author-name"),y=elById("rating-text"),A=elById("rating-img-container");i.removeAttribute("href");function p(e){T.href=`/zitate/share/${e}${r}`,$.href=`/zitate/${e}.gif${r}`;const[t,n]=e.split("-",2);u.href=`/zitate/info/z/${t}${r}`,g.href=`/zitate/info/a/${n}${r}`,m[0]=e}function b(e){if(e=e.toString(),y.innerText=e,["---","???","0"].includes(e)){A.innerHTML="";return}const t=Number.parseInt(e),n=document.createElement("div");n.className="rating-img"+(t>0?" witzig":" nicht-witzig"),A.innerHTML=(n.outerHTML+" ").repeat(Math.min(4,Math.abs(t))).trim()}function I(e){function t(n,v,d){n.disabled=!1,e===v||e===d?(n.setAttribute("voted",d),n.value="0"):(n.removeAttribute("voted"),n.value=d)}t(s,1,"1"),t(a,-1,"-1")}function c(e){if(e.status)return console.error(e),e.status in[429,420]&&alert(e.reason),!1;if(e!=null&&e.data.id){if(p(e.id),f[0]=e.next,u.innerText=`»${e.quote}«`,g.innerText=`- ${e.author}`,l.innerText=e.real_author,l.href=`/zitate/info/a/${e.real_author_id}${r}`,h){const t=new URLSearchParams(r);t.set("subject",`Das falsche Zitat ${e.id} hat ein Problem`),t.set("message",`${u.innerText} ${l.innerText}`),h.href=`/kontakt?${t.toString()}`}return b(e.rating),I(e.vote),!0}return!1}PopStateHandlers.quotes=e=>{e.state&&c(e.state)},i.onclick=()=>get(`/api/zitate/${f[0]}`,r,e=>{c(e)&&(e.stateType="quotes",e.url=`/zitate/${e.id}${r}`,window.history.pushState(e,"Falsche Zitate",e.url),setLastLocation(e.url))});const B=e=>post(`/api/zitate/${m[0]}`,{vote:e},t=>void c(t));for(const e of[s,a])e.type="button",e.onclick=()=>{s.disabled=!0,a.disabled=!0,B(e.value).then(()=>{s.disabled=!1,a.disabled=!1}).catch(()=>{s.disabled=!1,a.disabled=!1})}}for(const i of document.getElementsByClassName("auto-submit-element"))i.onchange=()=>i.form.submit();startQuotes();// @license-end
//# sourceMappingURL=quotes.js.map
