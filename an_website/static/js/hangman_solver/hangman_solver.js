// @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-3.0-or-later
import{PopStateHandlers as S,setMultipleURLParams as v}from"/static/js/utils/utils.js?v=de549338ff5782e1";var _="_",l=/_+/g,p=/[#?]/g,g=/\s+/g,x=/(.)(?=.*\1)/g;function y(){return document.getElementById("hangman-solver-form")}var c=e=>e.value.toLowerCase().replace(g,"");function d(){return{input:[document.querySelector("input[name='input']"),e=>c(e).replace(p,_)],invalid:[document.querySelector("input[name='invalid']"),e=>{let t=c(e).replace(p,"").replace(l,""),r=[...new Set(t)];return r.sort(),r.join("")}],max_words:[document.querySelector("input[name='max_words']"),e=>Number.parseInt(e.value,10)],crossword_mode:[document.querySelector("input[name='crossword_mode']"),e=>e.checked],lang:[document.querySelector("select[name='lang']"),c]}}function M(){let e=d();return{input:e.input[1](e.input[0]),invalid:e.invalid[1](e.invalid[0]),max_words:e.max_words[1](e.max_words[0]),crossword_mode:e.crossword_mode[1](e.crossword_mode[0]),lang:e.lang[1](e.lang[0])}}function T(){return{letterOutput:document.getElementById("letter-frequency-information"),wordOutput:document.getElementById("matching-words")}}function b(e){return((e.crossword_mode?"":e.input.replace(l,""))+e.invalid).toLowerCase().replace(g,"").replace(x,"")}function H(e){let t="[^"+b(e)+"]",r=e.input.replace(l,n=>t+(n.length>1?"{".concat(n.length,"}"):""));return new RegExp("^"+r+"$","u")}async function L(e){let t=[...e.input].length;try{return await C(e.lang,t)}catch(r){return console.error("error loading words",r),[]}}var f=new Map;async function C(e,t){let r=f.get(e);if(r){let o=r.get(t);if(o)return o}else r=new Map,f.set(e,r);let n=await fetch("/hangman-loeser/worte/".concat(e.toLowerCase(),"/").concat(t,".txt"),{method:"GET",headers:{Accept:"text/plain"}});n.status!==200&&n.status!==404&&console.error("error loading words",n);let s=n.ok?(await n.text()).split("\n"):[];return r.set(t,s),s}function w(e,t,r,n){var o,a,i;if(n){for(let u of r)e.set(u,((o=e.get(u))!=null?o:0)-1);for(let u of t)e.set(u,((a=e.get(u))!=null?a:0)+1);return}let s=[...r];for(let u of t)s.includes(u)||(e.set(u,((i=e.get(u))!=null?i:0)+1),s.push(u))}async function I(e){let t=await L(e),r=e.invalid,n=e.input.replace(l,""),s=r.length===0&&n.length===0;if(n.length===e.input.length){let o=n.toLowerCase();return O(t,o)?[[o],new Map]:[[],new Map]}else if(s){let o=new Map;return t.forEach(a=>{w(o,a,"",e.crossword_mode)}),[t,o]}else{let o=new Map,a=H(e);return[t.filter(i=>a.test(i)?(w(o,i,n,e.crossword_mode),!0):!1),o]}}async function h(e){let[t,r]=await I(e),n=T();if(t.length>0){n.wordOutput.innerHTML="".concat(Math.min(e.max_words,t.length),"/").concat(t.length," passenden Wörter:");let s=document.createElement("ul");for(let a of t.slice(0,e.max_words)){let i=document.createElement("li");i.innerText=a,s.appendChild(i)}n.wordOutput.appendChild(s);let o=[...r.entries()].filter(([a,i])=>i>0);o.sort((a,i)=>i[1]-a[1]),n.letterOutput.innerText="Mögliche Buchstaben: "+o.map(a=>a.join(": ")).join(", ")}else n.letterOutput.innerText="Nichts gefunden.",n.wordOutput.innerText=""}function O(e,t){let r=0,n=e.length-1;for(;r<=n;){let s=Math.floor((r+n)/2);if(e[s]===t)return!0;e[s]<t?r=s+1:n=s-1}return!1}var E="HangmanSolverState";function m(e=void 0){let t=M();return v(Object.entries(t).map(([r,n])=>[r,n.toString()]),t,E),e==null||e.preventDefault(),h(t)}function R(e){let t=d();t.input[0].value=e.input,t.crossword_mode[0].checked=e.crossword_mode,t.invalid[0].value=e.invalid,t.max_words[0].value=e.max_words.toString(),t.lang[0].value=e.lang}function j(e){let t=e.state;return R(t),e.preventDefault(),h(t)}function W(){S[E]=j,y().addEventListener("submit",m);let e=d();e.lang[0].addEventListener("change",m),e.crossword_mode[0].addEventListener("change",m)}W();export{C as _loadWords};
// @license-end
//# sourceMappingURL=hangman_solver.js.map
